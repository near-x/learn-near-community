# 什么是 NEAR 协议？

入门条件：无

阅读时间：16分钟

期望成果: 从最终用户的角度去基本了解 NEAR 的工作原理

NEAR是一个基于NEAR 区块链协议的去中心化的应用程式平台，目前在全世界范围内已运行在超过一百台机器上，每一台机器都是公开、完善的且足够安全的，可以创造一个强大且去中心化的新一代互联网的数据层。

NEAR的主要任务是提供一个理想的平台让应用程式运行，同时能访问到共享的且安全的资金池，在上面用户可以拥有自己的身份及数据资料。NEAR同时将抗分割网络、无服务器计算、分布式储存等特色结合在一起成了一种新型的平台。

在进一步深入学习之前，让我们先了解一些背景故事，看看区块链平台是如何随着时间发展。

## 区块链技术的演变
自从中本聪于 2008 年 10 月发布比特币白皮书以来，区块链技术已逐渐被世界所熟知。在过去的十年中，区块链经历了三个演进阶段。

### 第一代：比特币

比特币是第一代区块链的完美例子。该区块链的目的是成为一个简单直接的支付系统。从“互联网货币”开始，比特币已成为最受欢迎的资产类别之一。但是，当提及 比特币时就会出现一个重要问题：比特币无法应对包含多层元数据和运算逻辑的复杂交易。

### 第二代: 以太坊与智能合约平台

以太坊凭智能合约成为第二代区块链平台，让开发人员终于可以通过智能合约对复杂的交易[进行编程](https://learnnear.club/near-certified-developer-program-ncd/)。更可以创建去中心化应用程式(dApps)。透过dApps的应用，可以大大增加区块链的应用场景。

但区块链的发展一直与它的成长相互制约，因为区块链一直存在严重的扩展性问题。例如: 比特币每秒的交易量为7笔，而以太坊每秒的交易量只有25笔。当同PayPal(每秒115笔)和Visa(每秒1700笔)比较，就相当不济。

最近出现了一些第二层(Layer-two)解决方案，例如: Lightning Network Raiden, Plasma Protocal等，来应对以太坊与比特币的扩展性问题。这里的想法是在底层区块链上创建一个附加层，让主要的协议可以把重复且繁琐的工作委托给二层网络来解决。

但是，这种方法有两个问题。首先，这些第二层解决方案还没有被大众接受。其次，这些第二层解决方案破坏了协议的原始架构，这可能会产生长期影响。

因此，这就是第三代区块链发挥价值的地方。

### 第三代: NEAR

NEAR正是第三代区块链的一个例子，NEAR可以解决可扩展性问题，并让最终用户和开发人员充分享受智能合约和区块链技术的潜力。 NEAR 没有依赖于第 2 层技术，而是摆脱了参与网络的每个节点都必须运行所有代码的想法，因为这本质上会造成一个巨大的浪费并且影响所有其他工作的速度。

为了解决这个问题，NEAR 使用了一种在数据库领域中已经非常流行的技术----分片。如果适当运用，它可以允许网络容量随著网络中节点数量的增加而扩展，因此没有理论上的网络容量限制。更好的是，分片是一种针对第一层网络的可扩展性的技术。

## 什么是分片?
在数据库中，用户有时必须处理大量庞大的数据。这严重地妨碍了性能和吞吐量，并使整个过程的效率极低。因此，这就是分片发挥价值的地方。

分片对数据库进行水平分割，并变成更小、更易于管理的表。
![分片](https://learnnear.club/wp-content/uploads/2021/02/Sharding-NEAR.png)


那么，为什么是水平分割而不是垂直分割？
考虑以下这个表：
| A | B | A\*B | A/B |
| --- | --- | --- | --- |
| 1 | 1 | 1 | 1 |
| 2 | 2 | 4 | 1 |
| 3 | 3 | 9 | 1 |
| 4 | 4 | 16 | 1 |

现在，如果我们要垂直分割这个表：
| A | B |
| --- | --- |
| 1 | 1 |
| 2 | 2 |
| 3 | 3 |
| 4 | 4 |

| A\*B | A/B |
| --- | --- |
| 1 | 1 |
| 4 | 2 |
| 9 | 3 |
| 16 | 4 |

看到了吗？
由于垂直分割，该表变成了两个完全不同的表。

相反地，当表被水平分割时会发生什么：

你看到会发生什么吗？当你对表进行垂直分割时，它们会完全变成两个完全不同的表。

但是，如果我们将它们水平分割：
| A | B | A\*B | A/B |
| --- | --- | --- | --- |
| 3 | 3 | 9 | 1 |
| 4 | 4 | 16 | 1 |

看到了吗？

水平分割将数据库变成属于相同数据库的较小表。这些较小的数据库称为分片。

## 分片如何帮助区块链？

正如我们目前看到的，随着越来越多的节点进入以太坊和比特币生态系统，整个共识和验证过程需要更多的时间。那么，分片将如何帮助区块链？

分片将把区块链的全局状态分解成更小、更易于管理的”片“。

分片会发生什么？
* 全域状态被分割成很多分片
* 每个账户都存在于一个分片中，并且某个分片中的账户只能与同一分片中的其他账户进行交易。

简单来说，可以想像一下以下场景。
有一个虚拟网络具有三个节点 - A、B 和 C，它们必须验证数据 T。数据 T 被分解为三个分片 T1、T2 和 T3。不是所有这些节点都需要在全量的 T 上工作，它们可以同时单独在一个分片上工作。如你所看到的，所节省的时间会是指数级的。

相对而言，其他大部分的分片技术依然需要节点运行在越来越复杂的硬件上（最终导致能够参与节点营运的人减少了），而NEAR的技术允许节点保持足够精简，甚至在简单的云实例上运行。

## 为什么像 NEAR 这样的可扩展区块链是必需的？

这不只是关于速度！
当提及第二代和第三代区块链时，真正决定其内在价值的是在它们上面蓬勃发展的 dapp 生态系统。因此，大部分区块链平台都会无休止地竞争以尽量吸引更多的开发人员加入它们的生态系统。

不过，目前平台的问题在于它们没有完善的能力去托管高质量应用程式。这里的问题是我们有开发人员尝试在近似于 Windows 98 的平台上创建 PS4 游戏。因此，他们需要在其dApp 的整体功能上作出大量妥协以开发更多高质量的应用程序。

此外，这里应该考虑另一个因素。当涉及到应用程序的可用性方面，速度是一个必要的因素。毕竟，如果应用程序根本不能用，用户为什么要使用它？开发人员需要有一定数量的用户在其应用程序进行持续测试，以了解应用程序在某固定数量的用户下，可以运作多久 。

这就是为什么像NEAR这样的可扩展区块链平台对于区块链和智能合约的推广是很重要。

NEAR允许开发人员只部署他们的应用程序，而无需过多考虑其周围的基础设施如何运作或扩展，这更像是 Amazon AWS、GCP 或 Azure 等现代的云平台，它们驱动着现时绝大部分的 Web 应用程序。

## NEAR的简史
NEAR始于 2018 年夏天，当时 Alex Skidanov 和 Illia Polosukhin 决定放弃他们之前的创业冒险（可以在[这里阅读更多相关资料](https://medium.com/nearprotocol/near-ai-near-protocol-8785c9d32096)）。很快，随着 Misha 退出 MemSQL，团队在 8 月份的 3 天内从几人扩大到 9 人。最初的团队由 7 名工程师组成，Erik 负责业务营运，Sasha 负责市场营运。

今天，NEAR Collective由分布在全球的诸多个人和组织构成，他们都是自发组织起来的，目的是将NEAR这项技术实践出来。这并不是一项商业活动，而更像是有一群人正在运行的一个大型开源软件项目。

其中一个NEAR Collective的项目是为开源 NEAR 网络编写初始代码和参考实现，有点像在航天飞机上建造火箭助推器。他们的职责是做必要的研发工作来协助区块链步入正轨。由于NEAR的代码是[开源的](https://github.com/near)，所以任何人都可以作出贡献或运行它。

需要重点强调一下的是，像 NEAR 这样的网络是被设计为完全去中心化的。这表示NEAR最终完全独立运作，而且实际上无法被第三方删改、关闭或以其他方式扰乱。甚至最初构建它们的团队也不可以！因此，虽然这个Collective的成员在这里构建参考实现，但一旦网络开始运行，他们很快就会无法干预网络的运行。事实上，NEAR一旦完善，任何人都可以修改和运行 [NEAR 协议](https://learnnear.club/integrating-with-near-protocol/)代码来启动他们自己的区块链，因为它都是开源的，而且任何修改都必须被运行它的独立验证者们以民主的方式接受才能够被正式提交。

## NEAR 区块链的工作原理
NEAR的技术基于加密货币。区块链是一种技术，可以将交易记录安全地存储在点对点的网络上，而不是将它们存储在单一位置。世界各地的独立服务器，称为节点，组成了一个运行区块链的网络。
![NEAR区块链的工作原理](https://user-images.githubusercontent.com/41377418/126857629-90bfd47b-ec3d-4b2d-bf69-63d23fe66b25.png)

区块链技术最关键性的特点之一是去中心化。那么，为什么去中心化有用呢？让我们从开发者和最终用户的角度来看一下。
* 开发人员：在中心化的世界中，开发人员只能依赖云服务商以确保他们应用程式能够正常运行。在去中心化的世界里，没有专横跋扈的中介。
* 最终用户：去中心化应用程式的透明度可以让用户看到后端代码和明确地知道应用程序将会如何使用你的个人信息。

### 什么是NEAR 的共识算法？

共识协议是用于让系统中的多个参与者之间可以就单个价值达成一致共识。如果所有网络参与者都遵守共识协议进行合作，则新值可能会加到账本内并由节点进行验证。但是，在出现争议的情况下，网络会在安全性或活跃性中进行抉择以解决争议。

在 NEAR 上实现的共识机制称为 Nightshade。 Nightshade 将系统模彷为单个区块链。每个区块中所有交易纪录会被分成很多个物理块，每个分片只有一个块。所有块会累积到一起组成一个大块。请注意所有块只能由维护该分片状态的节点进行验证。

说到验证，NEAR 的一个关键组件是验证者。这些验证者负责维护协议内的共识。验证者是特定的节点，需要保持其服务器 100% 的在线时间，同时需要保持它的系统可以不断更新。

关于网络验证者，你必须记住以下几点。

* NEAR 会在每个纪元开始的时候根据参与者所持有的权益份额来选出网络验证者。
* 已经当选的验证者通过自动地重新抵押他们的通证和已累积的奖励来进行重新注册
* 潜在的验证者的其权益份额必须高于动态釐定的水平。
* 验证者可以使用两种方法来加强他们的权益份额-自己购买通证或通过其他人的权益委託而借入通证。
* 您所获得的奖励与您的权益份额成正比。您的权益份额越多，您的奖励就越多。

共识基于巨大链的共识。意思是，区块生产者一旦发布了一新的个区块，他们就会收集所有验证者节点的签名。一个区块的权重是根据在该区块中的所有签名者的签名中当时累积的权益份额。一条链的权重是所有区块的权重的总和。另外，共识使用了一个确定性小工具，该工具引入了额外的”删除条件”以提高链的安全性。

突击测验：一个块的权重是：
- [ ] 在该区块中的所有签名者的签名中当时最大的权益份额
- [ ] 在该区块中的所有签名者的签名中当时累积的权益份额
- [ ] 整个网络的平均权益份额除以在该区块中的签名者数量
- [ ] 以上皆不是

### NEAR Runtime

Runtime是用于执行用户创建的智能合约和其他操作，同时保留执行之间的状态。可以从三个不同的角度进行描述：逐步了解各种场景，描述Runtime的组件，以及描述Runtime可以提供的功能。

## 什么是 NEAR 通证？
NEAR通证是 NEAR 生态系统的基本原生资产，而且NEAR的通证功能都能被所有账户启用。每个通证都是一种独特的数字资产，与以太币相似，它可以用于：
* 向系统支付有关处理交易和存储数据的开支。
* 透过参与通证抵押过程，运行一个验证节点。
* 透过参与治理流程，帮助决定网络资源的分配形式和对未来的技术方向。

NEAR通证能够让所有运营网络的参加者之间达到经济协调，也可以良好的应对未来可能出现在NEAR网络上的新的功能。


# NEAR入门
## 账户/钱包
NEAR入门的第一件事，就是建立一个NEAR账户。

[请观看NEAR账户相关视频](https://youtu.be/2_Ekz7w6Eo4)


通过钱包，你可与发起智能合约调用，设置你的本地节点，收发资金。注册钱包账户ID时，你必须提供一个独一无二的名称。每个钱包都必须有唯一的名称，每个用户都可以创建多个钱包。

你可以想象这就类似脸书或者谷歌账户。一旦你注册了任一个服务，就可以使用相同的账户登录第三方服务。NEAR账户和谷歌账户之间的区别是那些代表账户的数据，是只能被钱包的所有者访问和管理的。除此以外，所有信息被存储在由节点组成的分布式网络上，而不是某个单独的服务器。

立刻[创建NEAR账户](https://wallet.near.org/create)

更多有关NEAR账户的内容请见[DOCS.NEAR](https://learnnear.club/doc/videos/accounts-keys/)

## NEAR 浏览器
NEAR 浏览器让你可以实时查看区块的创建！这个有用的工具可以查询[交易](https://learnnear.club/docs/concepts/transaction) 和 [账户](https://learnnear.club/docs/concepts/account)，让你可以查看用户和智能合约之间的所有交互。


# 如何获得NEAR通证?
有4种方式获得 $NEAR

## 以太坊用户可获得免费的NEAR
通过使用面向以太坊用户的水龙头[https://faucet.paras.id](https://faucet.paras.id)，用户可以得到一个拥有少量免费NEAR的钱包账户。

## 赚取NEAR
你可以通过参与[开发赏金任务](https://github.com/near/bounties)获得$NEAR, 运营一个帮助大家在NEAR上开发的[技术社区](https://near.org/guilds)，赢取NEAR黑客松比赛，或成为社区里的积极分子。如果你能吸引别人投NEAR给你抵押，你就可以成为一个验证人来赚取$NEAR。

## 购买NEAR
在一些大交易所（详情见下文）上都有$NEAR。在那里你可以注册并用加密货币或法币购买NEAR通证。

支持$NEAR的交易所

你可以在[coinmarketcap](https://coinmarketcap.com/currencies/near-protocol/) and [coingecko](https://www.coingecko.com/en/coins/near)上查看价格和交易对信息。

https://www.binance.com/en/my/wallet/exchange/deposit/crypto/NEAR

## 从朋友手里获得
你并不需要先有一个NEAR账户才能接收NEAR通证！“[NEAR Drop](https://near.org/blog/send-near-to-anyone-with-near-drops/)” 功能让你的朋友可以预付得到一个新账户并通过一个链接让你接收通证。

# 我拿着NEAR通证能做什么？
## 转账NEAR
将 $NEAR 在你和朋友的账户之间转来转去，并可以在[区块浏览器](https://explorer.mainnet.near.org/)里查看对应的交易。因为交易手续费非常低，你可以方便快捷的转移非常小额的NEAR玩玩。

把它们作为礼物通过[红包](http://redpacket.near.org/)送出去。

## 试试NEAR空投 (邀请朋友)
如果你的朋友想创建一个NEAR账户，可以给他们发送一个[NEAR空投](https://near.org/blog/send-near-to-anyone-with-near-drops/)。

## 使用NEAR应用
要查看日益增长的NEAR上的应用列表，[点击这里](https://awesomenear.com/categories/dapps/)。

轻松开启NFT之旅 - 购买/发布/交易 艺术品 就上 [https://paras.id/](https://paras.id/)

加入BerryClub参与艺术品的创作：[https://berryclub.io/](https://berryclub.io/)

# 使用NEAR的费用如何（Gas）？
当访问NEAR网络更新和改变数据时，运行网络基础架构的人就产生了一些开销。某些地方的某些计算机运行你的请求，而运营这些计算机的验证人需要支付显著的费用以确保这些计算机的运行。

与其他可编程网络类似，NEAR通过交易费，也叫Gas费补偿这些人。

如果你熟悉web2上的云服务提供商（亚马逊云，谷歌云等），区块链与其的最大不同是，用户在访问应用的时候直接支付费用，而不是开发者预付所有的基础设施费用。这带来了新的可能性，例如，应用本身规避了长期的入不敷出的资金风险。但这也带来了一些用户可用性上的阻碍。为了解决这个问题，NEAR也提供了让开发者支付用户使用开销的能力，让使用体验更靠近web2。

**考虑gas时要牢记的两个概念:**

1. Gas单位: 在内部，交易费不是直接用NEAR通证计算的，而是通过一个居中的gas单位。gas单位的好处是，他们是确定的，相同的交易总是消耗相同数量的gas单位。
2. Gas价格: gas单位乘以gas价格得到具体的向用户收取的费用。这个价格会在每个区块时根据网络需求自动重新计算（如果前面块的gas数量超过半满，则价格上升，否则价格下降，每个区块的价格变动不会超过1%）。最低的价格由网络配置决定，当前是1亿个yoctoNEAR。

注意：测试网和主网的gas价格可能不同。在直接使用下面的数字之前，要检查一下gas价格。

**从gas角度看**

NEAR的出块时间在一秒左右，这归功于对每个区块gas数量的限制。Gas的单位经过仔细合理的计算，形成了一些易于理解的数字：

10¹² 个gas, 叫 1 TGas (TeraGas)…

≈ 1 毫秒的“计算”时间

…这样一来，在最小1亿个yoctoNEAR每gas的价格下，等值于0.1个milliNEAR。

这里的1ms是一个粗略但有用的近似值，也是目前NEAR中对gas单位设定的目标。Gas单位不仅封装了计算/CPU时间，也包含带宽/网络时间和存储/IO时间。通过治理机制，将来系统参数是可以调整的，可以改变TGas与1毫秒之间的对应关系。即便如此，上面的内容也是一个不错的开始，让你了解单位gas的意义以及它是怎么得来的。 

**小测验: 1 TeraGas 或者说 TGas 是多少:**

1 TeraGas或TGas等于:  
1 微秒的计算时间  
10 秒的计算时间  
1 毫秒的计算时间
1 纳秒的计算时间

## 常见操作的费用
为了让大家了解NEAR上的费用有个切入点，下面的表格展示一些常见操作，以及目前它们所消耗的TGas，以及对应的NEAR，分别以千分之一NEAR，NEAR为单位。使用的gas价格是1亿个yN。

|操作|TGas|费用(单位mN)|费用(单位Ⓝ)|
|--|--|--|--|
|创建账户|0.42|0.042|4.2⨉10⁻⁵|
|转账|0.45|0.045|4.5⨉10⁻⁵|
|抵押|0.50|0.050|5.0⨉10⁻⁵|
|添加全权key|0.42|0.042|4.2⨉10⁻⁵|
|删除Key|0.41|0.041|4.1⨉10⁻⁵|

# 如何获得NEAR?
## 抵押你的NEAR
POS模型的关键点在于，社区是如何通过抵押而给予验证人支持的。验证人运营节点以支撑起整个网络，因此获得每年5%固定通胀率的NEAR通证奖励，具体是每个周期（约12个小时）创建出一批新的通证。

验证人必须维持一个确保让他们拥有验证人席位的最少抵押数量。通证持有者可以选择一个他们认为能可靠运行网络的验证人去抵押通证，同时按比例获得网络产生的收益。这样就能激励通证持有者持续关注社区!

NEAR钱包已经把用户抵押接口直接集成进了web应用中。

抵押:

1. 在导航条上选择 “Staking” (移动端是下拉框)
2. 点击“Select Validator”按钮
3. 选择一个人验证人
4. 确认你的选择并点击“Stake with Validator”
5. 输入你想要抵押的NEAR数量并点击“Submit Stake”

你需要确认两次交易，第一是选择验证者，第二是向验证者存入权益的数量。

解抵押:

1. 在抵押展示或抵押页面，选择你当前的验证人
2. 点击“Unstake”并确认交易

36到48小时（4个完整的周期）之后，就可以提取权益了。做法是回到验证人页面，点击“Withdraw”。

每周期作为奖励而新生的通证，其产生的大约间隔时间为：  
12 分钟  
12 秒  
12 天  
12 小时  

# 现在呢？我如何与NEAR互动？
接下来如何？如果你已经读到这里，也许会想更深入的了解[NEAR协议](https://learnnear.club/near-protocol-and-solana/). 所以接下来你可以查看[NEAR白皮书](https://near.org/papers/the-official-near-white-paper/). 如果你是个区块链新手，想要了解该领域本身，你可以查看这个视频[解析区块链生态](https://www.youtube.com/watch?v=Y21YtLzGbH0&ab_channel=NEAR).
加入 [NEAR Discord server](https://discord.gg/mxWQjvv8) 逛逛[NEAR论坛](https://gov.near.org/c/learn/33).

原文链接：https://learnnear.club/what-is-near-protocol/
